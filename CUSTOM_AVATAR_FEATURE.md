# 用户自定义头像功能说明

## 功能概述

yanbao AI 现在支持用户自定义设定模块的头像。用户可以从相册中选择任意照片作为个人头像，打造专属的个性化体验。

---

## 功能特性

### 1. 头像选择
- **从相册选择**: 点击头像右下角的相机按钮，从相册中选择照片
- **自动裁剪**: 支持 1:1 比例裁剪，确保头像显示效果完美
- **即时预览**: 选择后立即更新显示

### 2. 头像管理
- **持久化存储**: 头像数据保存在本地，关闭 App 后依然保留
- **恢复默认**: 长按头像右下角的相机按钮，可以恢复默认头像（雁宝动漫头像）
- **权限管理**: 自动请求相册访问权限，确保用户隐私安全

### 3. 交互体验
- **触觉反馈**: 每次操作都有震动反馈（iOS/Android）
- **成功提示**: 更换头像成功后显示确认提示
- **错误处理**: 操作失败时显示友好的错误提示

---

## 使用方法

### 更换头像

1. 打开 yanbao AI 应用
2. 进入"设定"标签页
3. 点击头像右下角的**相机按钮**（🎥）
4. 允许访问相册权限（首次使用时）
5. 从相册中选择一张照片
6. 调整裁剪区域（1:1 比例）
7. 点击"选择"确认

✅ 头像立即更新！

### 恢复默认头像

1. 进入"设定"标签页
2. **长按**头像右下角的相机按钮
3. 在弹出的确认对话框中点击"确定"

✅ 头像恢复为雁宝动漫头像！

---

## 技术实现

### 核心组件

#### AvatarService
头像存储服务，负责头像数据的持久化管理。

**主要方法**:
- `saveAvatar(uri: string)`: 保存头像 URI
- `getAvatar()`: 获取当前头像 URI
- `deleteAvatar()`: 删除头像（恢复默认）

**存储方式**: AsyncStorage（React Native 本地存储）

#### Settings Screen
设定页面，集成头像选择和显示功能。

**核心功能**:
- 头像加载：App 启动时自动加载用户头像
- 头像选择：使用 `expo-image-picker` 打开相册
- 头像显示：动态切换用户头像和默认头像

---

## 视觉设计

### 头像样式
- **尺寸**: 100x100 像素
- **形状**: 圆形（borderRadius: 50）
- **阴影**: 紫色光晕效果
- **动画**: 点击时有弹跳动画

### 编辑按钮
- **位置**: 头像右下角
- **尺寸**: 32x32 像素
- **图标**: 相机图标（Ionicons）
- **颜色**: 主题紫色
- **边框**: 3px 白色边框

---

## 权限要求

### iOS
需要在 `app.json` 中配置相册访问权限：
```json
{
  "ios": {
    "infoPlist": {
      "NSPhotoLibraryUsageDescription": "需要访问您的相册以选择头像"
    }
  }
}
```

### Android
需要在 `app.json` 中配置相册访问权限：
```json
{
  "android": {
    "permissions": [
      "READ_EXTERNAL_STORAGE",
      "WRITE_EXTERNAL_STORAGE"
    ]
  }
}
```

---

## 未来优化方向

1. **头像编辑器**: 内置裁剪、滤镜、贴纸等编辑功能
2. **头像历史**: 保存最近使用的头像，方便快速切换
3. **云端同步**: 将头像同步到云端，支持多设备共享
4. **AI 生成**: 使用 AI 生成个性化头像
5. **动态头像**: 支持 GIF 或视频作为头像

---

## 版本信息

- **功能版本**: v2.4.2
- **提交 ID**: 43d75ba
- **发布日期**: 2026-01-15

---

**by Jason Tsao who loves you the most ♥**
