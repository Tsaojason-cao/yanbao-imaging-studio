# yanbao AI v2.4.2 - 图片压缩策略

## 🎯 目标

将图片资产总体积从 **19 MB** 进一步压缩至 **10 MB 以下**，在不显著牺牲视觉质量的前提下，最大化减少 APK 包体大小。

---

## 📊 当前资产分析

- **总大小**: 19 MB
- **文件数量**: 50 个 (PNG/JPG)
- **主要构成**: 库洛米主题素材、UI 图标、背景图

---

## 🚀 压缩策略

### 1. 格式转换：PNG -> WebP (首选)

- **策略**: 将所有非透明背景的 PNG 图片转换为 WebP 格式。
- **优势**: WebP 在相同质量下，体积比 PNG 小 25-35%。
- **工具**: `cwebp` (Google 官方工具)
- **命令示例**:
  ```bash
  cwebp -q 80 input.png -o output.webp
  ```
- **预期效果**: 预计可将 15 MB 的 PNG 资源压缩至 10 MB 左右。

### 2. 尺寸优化：按需缩放

- **策略**: 根据图片在 UI 中的实际显示尺寸，生成不同分辨率的图片版本。
- **优势**: 避免在小尺寸视图中加载大尺寸图片，浪费内存和带宽。
- **工具**: `ImageMagick` 或 `sharp` (Node.js 库)
- **实现**: 在 `assets/images` 目录下创建 `@1x`, `@2x`, `@3x` 子目录，存放不同分辨率的图片。
- **示例**: 对于一个 100x100px 的图标，可以生成：
  - `icon@1x.png` (100x100)
  - `icon@2x.png` (200x200)
  - `icon@3x.png` (300x300)
- **预期效果**: 减少内存占用，提升渲染性能。

### 3. 自动化压缩流程

- **策略**: 创建一个自动化脚本，在构建前自动执行所有压缩和转换操作。
- **工具**: Shell 脚本或 Node.js 脚本
- **步骤**:
  1. 遍历 `assets/images` 目录
  2. 对每个 PNG 文件执行 `cwebp` 转换
  3. 对每个图片执行尺寸优化
  4. 对转换后的 WebP 和优化后的 PNG 执行 `optipng` / `pngquant` 最终压缩
  5. 替换原始文件

---

## 💡 实施建议

1. **优先转换大尺寸背景图**: `kuromi-loading-*.png` 等背景图是压缩的重点。
2. **保留透明背景的 PNG**: 对于需要透明通道的图标，继续使用 PNG 格式，但执行深度压缩。
3. **引入 `expo-image`**: 使用 `expo-image` 组件代替 React Native 的 `Image` 组件，它能更好地支持 WebP 格式和高级缓存策略。

---

## 📈 预期成果

| 策略 | 预期体积减少 | 预期性能提升 |
| :--- | :--- | :--- |
| **格式转换 (WebP)** | 5-8 MB | - |
| **尺寸优化** | 1-2 MB | 渲染速度提升 10-15% |
| **自动化流程** | - | 提升开发效率 |
| **总计** | **6-10 MB** | **渲染速度提升 10-15%** |

通过实施以上策略，预计可将图片资产总体积从 19 MB 降至 **9-13 MB**，成功实现 **10 MB 以下** 的目标。
